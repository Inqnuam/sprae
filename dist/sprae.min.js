var Q=Object.defineProperty;var U=(e,o)=>{for(var t in o)Q(e,t,{get:o[t],enumerable:!0})};var O,p,T,P,j;function q(e){O=e.signal,p=e.effect,j=e.computed,P=e.batch||(o=>o()),T=e.untracked||P}var x=Symbol("signals"),E=Symbol("length");function v(e,o){if(!e||e[x])return e;if(Array.isArray(e))return ee(e);if(e.constructor!==Object)return e;let t={...o?.[x]},r=O(Object.values(e).length),s=new Proxy(t,{get:(n,i)=>i===E?r:i===x?t:t[i]?.valueOf(),set:(n,i,c,a)=>(a=t[i],I(t,i,c),a??++r.value,1),deleteProperty:(n,i)=>(t[i]&&(B(t,i),r.value--),1),ownKeys(){return r.value,Reflect.ownKeys(t)}});for(let n in e){let i=Object.getOwnPropertyDescriptor(e,n);i?.get?(t[n]=j(i.get.bind(s)))._set=i.set?.bind(s):(t[n]=void 0,I(t,n,e[n]))}return s}var Y={push:1,pop:1,shift:1,unshift:1,splice:1};function ee(e){let o;if(e[x])return e;let t=O(e.length),r=Array(e.length).fill(),s=new Proxy(r,{get(n,i){if(typeof i=="symbol")return i===E?t:i===x?r:r[i];if(i==="length")return Y[o]?t.peek():t.value;if(o=i,r[i])return r[i].valueOf();if(i<r.length)return(r[i]=O(v(e[i]))).value},set(n,i,c){if(i==="length"){for(let a=c,y=r.length;a<y;a++)delete s[a];return t.value=r.length=c,!0}return I(r,i,c),i>=t.peek()&&(t.value=r.length=Number(i)+1),!0},deleteProperty:(n,i)=>(r[i]&&B(r,i),1)});return s}function I(e,o,t){let r=e[o];if(o[0]==="_")e[o]=t;else if(!r)e[o]=r=t?.peek?t:O(v(t));else if(t!==r.peek())if(r._set)r._set(t);else if(Array.isArray(t)&&Array.isArray(r.peek())){let s=r.peek();s[E]?T(()=>{P(()=>{let n=0,i=t.length;for(;n<i;n++)s[n]=t[n];s.length=i})}):r.value=t}else r.value=v(t)}function B(e,o){let t=e[o],r=t[Symbol.dispose];r&&delete t[Symbol.dispose],delete e[o],r?.()}var M=Symbol.dispose||(Symbol.dispose=Symbol("dispose")),f={},g=new WeakMap;function d(e,o){if(!e?.childNodes)return;if(g.has(e))return Object.assign(g.get(e),o);let t=v(o||{}),r=[];return s(e),g.has(e)||g.set(e,t),e[M]=()=>{for(;r.length;)r.pop()();g.delete(e)},t;function s(n,i=n.parentNode){if(!!n.childNodes){for(let c=0;c<n.attributes?.length;){let a=n.attributes[c];if(a.name[0]===":"){n.removeAttribute(a.name);let y=a.name.slice(1).split(":");for(let k of y){let u=f[k]||f.default,l=(u.parse||W)(a.value),h=u(n,l,t,k);h&&r.push(h)}if(g.has(n))return n[M]&&r.push(n[M]);if(n.parentNode!==i)return}else c++}for(let c of[...n.childNodes])s(c,n)}}}var H={},W=(e,o,t)=>{if(t=H[e=e.trim()])return t;try{t=V(e)}catch(r){R(r,o,e)}return H[e]=t},R=(e,o,t="")=>{throw Object.assign(e,{message:`\u2234 ${e.message}

${o}${t?`="${t}"

`:""}`,expr:t})},V;d.use=e=>{e.signal&&q(e),e.compile&&(V=e.compile)};var N=e=>{if(!e.nodeType)return e;let o=e.content.cloneNode(!0),t=[...e.attributes],r=document.createTextNode(""),s=(o.append(r),[...o.childNodes]);return{childNodes:s,content:o,remove:()=>o.append(...s),replaceWith(n){n!==r&&(r.before(n),o.append(...s))},attributes:t,removeAttribute(n){t.splice(t.findIndex(i=>i.name===n),1)}}};var F={};U(F,{batch:()=>re,computed:()=>te,effect:()=>Z,signal:()=>X,untracked:()=>oe});var w,$,X=(e,o,t=new Set)=>(o={get value(){return w?.deps.push(t.add(w)),e},set value(r){if(r!==e){e=r;for(let s of t)$?$.add(s):s()}},peek(){return e}},o.toJSON=o.then=o.toString=o.valueOf=()=>o.value,o),Z=(e,o,t,r)=>(t=s=>{o?.call?.(),s=w,w=t;try{o=e()}finally{w=s}},r=t.deps=[],t(),s=>{for(o?.call?.();s=r.pop();)s.delete(t)}),te=(e,o=X(),t,r)=>(t={get value(){return r||(r=Z(()=>o.value=e())),o.value},peek:o.peek},t.toJSON=t.then=t.toString=t.valueOf=()=>t.value,t),re=e=>{let o=$;o||($=new Set);try{e()}finally{if(!o){o=$,$=null;for(let t of o)t()}}},oe=(e,o,t)=>(o=w,w=null,t=e(),w=o,t);var z=Symbol("if");f.if=(e,o,t)=>{let r=e.nextElementSibling,s=document.createTextNode(""),n,i,c;return e.replaceWith(s),i=e.content?N(e):e,g.set(i,null),r?.hasAttribute(":else")&&(r.removeAttribute(":else"),r.hasAttribute(":if")||(r.remove(),c=r.content?N(r):r,g.set(c,null))),p(()=>{let a=o(t)?i:e[z]?null:c;r&&(r[z]=a===i),n!=a&&(n?.remove(),(n=a)&&(s.before(n.content||n),g.get(n)===null&&g.delete(n),d(n,t)))})};f.each=(e,[o,t,r],s)=>{let n=document.createTextNode("");e.replaceWith(n);let i,c,a=0,y=j(()=>{c=null;let l=r(s);return typeof l=="number"&&(l=Array.from({length:l},(h,b)=>b+1)),l?.constructor===Object&&(c=Object.keys(l),l=Object.values(l)),l||[]}),k=()=>{T(()=>{var S,C;let l=0,h=y.value,b=h.length;if(i&&!i[E]){for(let A of i[x]||[])A[Symbol.dispose]();i=null,a=0}if(b<a)i.length=b;else{if(!i)i=h;else for(;l<a;l++)i[l]=h[l];for(;l<b;l++){i[l]=h[l];let A=l,K=v({[o]:i[x]?.[A]||i[A],[t]:c?c[A]:A},s),_=e.content?N(e):e.cloneNode(!0);n.before(_.content||_),d(_,K),((C=i[S=x]||(i[S]=[]))[l]||(C[l]={}))[Symbol.dispose]=()=>{_[Symbol.dispose](),_.remove()}}}a=b})},u=0;return p(()=>{y.value[E]?.value,u?u++:(k(),queueMicrotask(()=>(u&&k(),u=0)))})};f.each.parse=e=>{let[o,t]=e.split(/\s+in\s+/),[r,s="$"]=o.split(/\s*,\s*/);return[r,s,W(t)]};f.ref=(e,o,t)=>{t[o]=e};f.ref.parse=e=>e;f.with=(e,o,t)=>{let r;return p(()=>{let s=o(t);d(e,r?s:r=v(s,t))})};f.html=(e,o,t)=>{let r=o(t);if(!r)return;let s=(r.content||r).cloneNode(!0);e.replaceChildren(s),d(e,t)};f.text=(e,o,t)=>(e.content&&e.replaceWith(e=N(e).childNodes[0]),p(()=>{let r=o(t);e.textContent=r??""}));f.class=(e,o,t)=>{let r=new Set;return p(()=>{let s=o(t),n=new Set;s&&(typeof s=="string"?s.split(" ").map(i=>n.add(i)):Array.isArray(s)?s.map(i=>i&&n.add(i)):Object.entries(s).map(([i,c])=>c&&n.add(i)));for(let i of r)n.has(i)?n.delete(i):e.classList.remove(i);for(let i of r=n)e.classList.add(i)})};f.style=(e,o,t)=>{let r=e.getAttribute("style")||"";return r.endsWith(";")||(r+="; "),p(()=>{let s=o(t);if(typeof s=="string")e.setAttribute("style",r+s);else{e.setAttribute("style",r);for(let n in s)e.style.setProperty(n,e.style[n]=s[n])}})};f.default=(e,o,t,r)=>{if(!r.startsWith("on"))return p(()=>{let u=o(t);if(r)D(e,r,u);else for(let l in u)D(e,le(l),u[l])});let s=r.split("..").map(u=>{let l={evt:"",target:e,test:()=>!0};return l.evt=(u.startsWith("on")?u.slice(2):u).replace(/\.(\w+)?-?([-\w]+)?/g,(h,b,S="")=>(l.test=ie[b]?.(l,...S.split("-"))||l.test,"")),l});if(s.length==1)return p(()=>k(o(t),s[0]));let n,i,c,a=0,y=u=>{c=k(l=>(c(),i=u?.(l),(a=++a%s.length)?y(i):n&&y(n)),s[a])};return p(()=>(n=o(t),!c&&y(n),()=>n=null));function k(u,{evt:l,target:h,test:b,defer:S,stop:C,prevent:A,immediate:K,..._}){S&&(u=S(u));let J=L=>{try{b(L)&&(C&&(K?L.stopImmediatePropagation():L.stopPropagation()),A&&L.preventDefault(),u?.(L))}catch(G){R(G,`:on${l}`,u)}};return h.addEventListener(l,J,_),()=>h.removeEventListener(l,J,_)}};var ie={prevent(e){e.prevent=!0},stop(e){e.stop=!0},immediate(e){e.immediate=!0},once(e){e.once=!0},passive(e){e.passive=!0},capture(e){e.capture=!0},window(e){e.target=window},document(e){e.target=document},throttle(e,o){e.defer=t=>ne(t,o?Number(o)||0:108)},debounce(e,o){e.defer=t=>se(t,o?Number(o)||0:108)},outside:e=>o=>{let t=e.target;return!(t.contains(o.target)||o.target.isConnected===!1||t.offsetWidth<1&&t.offsetHeight<1)},self:e=>o=>o.target===e.target,ctrl:(e,...o)=>t=>m.ctrl(t)&&o.every(r=>m[r]?m[r](t):t.key===r),shift:(e,...o)=>t=>m.shift(t)&&o.every(r=>m[r]?m[r](t):t.key===r),alt:(e,...o)=>t=>m.alt(t)&&o.every(r=>m[r]?m[r](t):t.key===r),meta:(e,...o)=>t=>m.meta(t)&&o.every(r=>m[r]?m[r](t):t.key===r),arrow:()=>m.arrow,enter:()=>m.enter,esc:()=>m.esc,tab:()=>m.tab,space:()=>m.space,delete:()=>m.delete,digit:()=>m.digit,letter:()=>m.letter,char:()=>m.char},m={ctrl:e=>e.ctrlKey||e.key==="Control"||e.key==="Ctrl",shift:e=>e.shiftKey||e.key==="Shift",alt:e=>e.altKey||e.key==="Alt",meta:e=>e.metaKey||e.key==="Meta"||e.key==="Command",arrow:e=>e.key.startsWith("Arrow"),enter:e=>e.key==="Enter",esc:e=>e.key.startsWith("Esc"),tab:e=>e.key==="Tab",space:e=>e.key==="\xA0"||e.key==="Space"||e.key===" ",delete:e=>e.key==="Delete"||e.key==="Backspace",digit:e=>/^\d$/.test(e.key),letter:e=>/^\p{L}$/gu.test(e.key),char:e=>/^\S$/.test(e.key)},D=(e,o,t)=>{t==null||t===!1?e.removeAttribute(o):e.setAttribute(o,t===!0?"":typeof t=="number"||typeof t=="string"?t:"")},ne=(e,o)=>{let t,r,s=n=>{t=!0,setTimeout(()=>{if(t=!1,r)return r=!1,s(n),e(n)},o)};return n=>t?r=!0:(s(n),e(n))},se=(e,o)=>{let t;return r=>{clearTimeout(t),t=setTimeout(()=>{t=null,e(r)},o)}},le=e=>e.replace(/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,o=>"-"+o.toLowerCase());f.value=(e,[o,t],r)=>{let s=e.type==="text"||e.type===""?i=>e.setAttribute("value",e.value=i??""):e.tagName==="TEXTAREA"||e.type==="text"||e.type===""?(i,c,a)=>(c=e.selectionStart,a=e.selectionEnd,e.setAttribute("value",e.value=i??""),c&&e.setSelectionRange(c,a)):e.type==="checkbox"?i=>(e.checked=i,D(e,"checked",i)):e.type==="select-one"?i=>{for(let c in e.options)c.removeAttribute("selected");e.value=i,e.selectedOptions[0]?.setAttribute("selected","")}:i=>e.value=i,n=e.type==="checkbox"?i=>t(r,e.checked):i=>t(r,e.value);return e.addEventListener("input",n),e.addEventListener("change",n),p(()=>s(o(r)))};f.value.parse=e=>{let o=[W(e)];try{o.push(W(`${e}=arguments[1];`))}catch{}return o};f.fx=(e,o,t)=>p(()=>o(t));d.use(F);d.use({compile:e=>d.constructor(`with (arguments[0]) { return ${e} };`)});var ot=d;export{ot as default};
